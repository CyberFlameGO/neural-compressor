:orphan:

:py:mod:`neural_compressor.utils`
=================================

.. py:module:: neural_compressor.utils


Submodules
----------
.. toctree::
   :titlesonly:
   :maxdepth: 1

   utility/index.rst


Package Contents
----------------

Classes
~~~~~~~

.. autoapisummary::

   neural_compressor.utils.KL_Divergence
   neural_compressor.utils.LayerHistogramCollector




.. py:class:: KL_Divergence

   Bases: :py:obj:`object`

   The class of supporting KL divergence calibration algorithm.

   :param TODO:

   .. py:method:: expand_quantized_bins(quantized_bins, reference_bins)

      expand quantized bins


   .. py:method:: safe_entropy(reference_distr_P, P_sum, candidate_distr_Q, Q_sum)

      safe entropy


   .. py:method:: get_threshold(hist, hist_edges, min_val, max_val, num_bins, quantized_type, num_quantized_bins=255)

      The interface of getting threshold per KL divergency algorithm.

      :param historgram: The tensor numpy array list including all ops
                         in each iteration.
      :type historgram: tensor list
      :param quantized_type: string being "int8" or "uint8".
      :type quantized_type: string
      :param number_bins: number of bins used in KL.
      :type number_bins: integer

      :returns: threshold per quantized ops, it's scalar.



.. py:class:: LayerHistogramCollector(num_bins=8001, layer_tensor=None, include_layer=None, logger=None)

   Bases: :py:obj:`object`

   Saves layer histogram in a dict with layer names as keys and lists of NDArrays as
   values. The collected histogram will be used for calculating the optimal thresholds for
   quantization using KL divergence.

   .. py:method:: collect()

      Callback function for collecting layer output NDArrays.



